<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pipeline Editor - NIRSCAPE</title>
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
</head>
<body class="bg-gray-50 text-gray-800">
    <div class="flex h-screen">
        <!-- Navigation Sidebar -->
        <div class="w-64 bg-white shadow-lg border-r border-gray-200">
            <div class="p-6 border-b border-gray-200">
                <h1 class="text-xl font-bold text-gray-800 flex items-center">
                    <i data-feather="activity" class="mr-2 text-blue-600"></i>
                    NIRSCAPE
                </h1>
                <p class="text-sm text-gray-600 mt-1">NIRS Analysis Platform</p>
            </div>
            <nav class="mt-6">
                <a href="index.html" class="sidebar-item flex items-center px-6 py-3 text-gray-700 hover:bg-blue-50 transition-colors">
                    <i data-feather="home" class="mr-3"></i>
                    Home
                </a>
                <a href="workspace.html" class="sidebar-item flex items-center px-6 py-3 text-gray-700 hover:bg-blue-50 transition-colors">
                    <i data-feather="folder" class="mr-3"></i>
                    Workspace
                </a>
                <a href="pipeline.html" class="sidebar-item active flex items-center px-6 py-3 text-gray-700 hover:bg-blue-50 transition-colors">
                    <i data-feather="git-branch" class="mr-3"></i>
                    Pipeline Editor
                </a>
                <body>
                    <meta http-equiv="refresh" content="0; url=/webapp/pipeline.html" />
                    <style>body{font-family: Arial, Helvetica, sans-serif; padding: 2rem;}</style>
                    <h1>Moved</h1>
                    <p>The UI mockup was moved to <a href="/webapp/pipeline.html">/webapp/pipeline.html</a>.
                       The original mockup content has been archived to
                       <code>/archives/webapp_mockup_backup/</code>.</p>
            component.addEventListener('dragend', () => {
                component.classList.remove('opacity-50');
            });
        });

        canvas.addEventListener('dragover', (e) => {
            e.preventDefault();
            canvas.classList.add('drag-over');
        });

        canvas.addEventListener('dragleave', () => {
            canvas.classList.remove('drag-over');
        });

        canvas.addEventListener('drop', (e) => {
            e.preventDefault();
            canvas.classList.remove('drag-over');

            const componentType = e.dataTransfer.getData('text/plain');
            addComponentToCanvas(componentType);
        });
        function addComponentToCanvas(type) {
            const component = document.createElement('div');
            component.className = 'bg-white border border-gray-200 rounded-lg p-4 mb-3 shadow-sm';
            component.innerHTML = `
                <div class="flex justify-between items-center mb-2">
                    <span class="font-medium">${type.replace(/_/g, ' ').toUpperCase()}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="text-gray-400 hover:text-red-600">
                        <i data-feather="x" class="w-4 h-4"></i>
                    </button>
                </div>
                <div class="text-sm text-gray-600">Click to configure parameters</div>
                <div class="param-accordion mt-2 hidden">
                    <div class="space-y-2">
                        <input type="text" placeholder="Parameter 1" class="w-full border border-gray-300 rounded px-2 py-1 text-sm">
                        <input type="text" placeholder="Parameter 2" class="w-full border border-gray-300 rounded px-2 py-1 text-sm">
                    </div>
                </div>
            `;

            component.addEventListener('click', () => {
                const accordion = component.querySelector('.param-accordion');
                accordion.classList.toggle('hidden');
                accordion.style.maxHeight = accordion.classList.contains('hidden') ? '0' : '100px';
            });

            canvas.querySelector('p')?.remove();
            canvas.appendChild(component);
            feather.replace();
        }

        function toggleAccordion(section) {
            const content = document.getElementById(`${section}-content`);
            const chevron = document.getElementById(`${section}-chevron`);
            const isHidden = content.classList.contains('hidden');

            content.classList.toggle('hidden');
            chevron.classList.toggle('rotate-180');
        }

        function toggleSubAccordion(subsection) {
            const content = document.getElementById(`${subsection}-content`);
            content.classList.toggle('hidden');
        }
</script>
</body>
</html>
