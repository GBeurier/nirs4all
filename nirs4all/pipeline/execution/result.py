"""Result types for pipeline execution."""
from dataclasses import dataclass, field
from pathlib import Path
from typing import Any, Dict, List, Optional

from nirs4all.data.dataset import SpectroDataset
from nirs4all.data.predictions import Predictions


@dataclass
class ArtifactMeta:
    """Metadata about a persisted artifact.

    Attributes:
        name: Artifact identifier (e.g., 'model', 'scaler')
        content_hash: Content-based hash for deduplication
        path: Relative path from artifacts directory
        format: Artifact format (e.g., 'joblib', 'h5', 'safetensors')
        format_version: Version of the library used (e.g., 'sklearn==1.3.0')
        nirs4all_version: Version of nirs4all used (e.g., '0.4.1')
        metadata: Additional artifact metadata
    """
    name: str
    content_hash: str
    path: str
    format: str
    format_version: str = ""
    nirs4all_version: str = ""
    metadata: Dict[str, Any] = field(default_factory=dict)


@dataclass
class StepResult:
    """Result of executing a single pipeline step.

    Attributes:
        updated_context: Updated execution context after step
        artifacts: List of artifacts persisted during step execution
        predictions: Optional predictions generated by this step
    """
    updated_context: Any  # Union[Dict[str, Any], ExecutionContext]
    artifacts: List[ArtifactMeta] = field(default_factory=list)
    predictions: Optional[Predictions] = None

